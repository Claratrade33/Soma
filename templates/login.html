{% extends 'base.html' %}
{% block content %}
<h2>Login</h2>
<form onsubmit="event.preventDefault(); login();">
  <input id="username" placeholder="UsuÃ¡rio"><br>
  <input id="password" type="password" placeholder="Senha"><br>
  <button type="submit">Entrar</button>
</form>
<script>
async function login(){
  const u=document.getElementById('username').value;
  const p=document.getElementById('password').value;
  const resp=await fetch('/login',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({username:u,password:p})
  });
  const data=await resp.json();
  if(data.access_token){
    localStorage.setItem('token',data.access_token);
    window.location='/chat';
  } else {
    alert(data.msg||'Erro no login');
  }
}
</script>
{% endblock %}
