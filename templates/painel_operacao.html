{% extends "base.html" %}
{% block title %}Painel de Operação • ClaraVerse{% endblock %}

{% block content %}
<div style="padding: 30px; max-width: 1100px; margin: auto;">

  <h2 style="color: #00ffff; text-align: center; margin-bottom: 20px;">📊 Painel de Operações ClaraVerse</h2>

  <div id="resposta-ia" style="margin-bottom: 25px; background: #1e1e1e; padding: 15px; border-radius: 8px; box-shadow: 0 0 10px #00ffff;">
    <h3 style="color: #fff;">🤖 IA Clarinha aguardando comandos...</h3>
  </div>

  <div style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; margin-bottom: 30px;">
    <button class="botao-acao" data-acao="ENTRADA">📥 Entrada</button>
    <button class="botao-acao" data-acao="STOP">🛑 Stop</button>
    <button class="botao-acao" data-acao="ALVO">🎯 Alvo</button>
    <button class="botao-acao" data-acao="EXECUTAR">⚡ Executar</button>
    <button class="botao-acao" data-acao="AUTOMATICO">🤖 Automático</button>
  </div>

  <div class="painel-dados">
    <h4 style="color:#00ffff; margin-bottom: 10px;">Criptomoedas (BTC/USDT)</h4>
    <table id="crypto-table">
      <thead>
        <tr>
          <th>Moeda</th>
          <th>Preço</th>
          <th>24h</th>
          <th>Volume</th>
          <th>RSI</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h4 style="color:#00ffff; margin-top: 30px;">Mercado Brasileiro</h4>
    <table id="br-table">
      <thead>
        <tr>
          <th>Papel</th>
          <th>Preço</th>
          <th>24h</th>
          <th>Volume</th>
          <th>RSI</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div style="margin-top: 40px;">
    <h3 style="color:#00ffff;">📈 Últimas Operações</h3>
    {% if trades %}
      <table>
        <thead>
          <tr>
            <th>Par</th>
            <th>Lado</th>
            <th>Quantidade</th>
            <th>Entrada</th>
            <th>Saída</th>
            <th>Resultado</th>
            <th>Estratégia</th>
            <th>Horário</th>
          </tr>
        </thead>
        <tbody>
          {% for t in trades %}
          <tr>
            <td>{{ t.symbol }}</td>
            <td>{{ t.side }}</td>
            <td>{{ t.quantity }}</td>
            <td>{{ t.entry_price }}</td>
            <td>{{ t.exit_price or '—' }}</td>
            <td>{{ t.profit_loss or '—' }}</td>
            <td>{{ t.strategy_used or '—' }}</td>
            <td>{{ t.timestamp.strftime('%d/%m %H:%M') }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p style="color:#ccc;">Nenhuma operação registrada ainda.</p>
    {% endif %}
  </div>

</div>
<script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
<script src="{{ url_for('static', filename='dashboard.js') }}"></script>
{% endblock %}